<div class="commandes-container">
  <h2>📦 Mes Commandes</h2>

  <div *ngIf="commandes.length > 0; else pasDeCommande">
    <div *ngFor="let cmd of commandes" class="commande-card">
      <!-- Header -->
      <div class="commande-header">
        <div>
          <h3>Commande #{{ cmd.id }}</h3>
          <p>{{ cmd.dateCreation | date:'short' }}</p>
        </div>
        <div class="commande-total">
          <strong>Total :</strong> {{ cmd.total | number:'1.2-2' }} DT
        </div>
      </div>

      <!-- Timeline progressive -->
      <div class="timeline">
        <div 
          *ngFor="let step of steps" 
          class="step" 
          [class.active]="getActiveSteps(cmd.statut).includes(step)">
          
          <div class="circle">
            <ng-container [ngSwitch]="step">
              <span *ngSwitchCase="'EnCours'">📝</span>
              <span *ngSwitchCase="'Validée'">✅</span>
              <span *ngSwitchCase="'Expédiée'">📦</span>
              <span *ngSwitchCase="'Livrée'">🚚</span>
            </ng-container>
          </div>
          <div class="label">{{ step }}</div>
        </div>

        <!-- Cas spécial annulée -->
        <div class="step cancelled" *ngIf="cmd.statut === 'Annulee'">
          <div class="circle">❌</div>
          <div class="label">Annulée</div>
        </div>
      </div>

      <!-- Produits -->
      <div class="produits-commande">
        <div *ngFor="let item of cmd.items" class="produit-item">
          <div class="produit-nom">{{ item.nomProduit }}</div>
          <div class="produit-prix">{{ item.prixUnitaire }} DT</div>
        </div>
      </div>

      <!-- Actions -->
      <div class="commande-actions">
        <button *ngIf="cmd.statut === 'EnCours'" class="btn-annuler"
                (click)="annulerCommande(cmd.id)">
          ❌ Annuler
        </button>
      </div>
    </div>
  </div>

  <ng-template #pasDeCommande>
    <p class="no-commandes">Vous n'avez encore passé aucune commande.</p>
  </ng-template>
</div>
