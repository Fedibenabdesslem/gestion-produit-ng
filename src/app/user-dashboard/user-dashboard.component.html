<div class="dashboard-container">

  <!-- ---------------- Vitrine des produits ---------------- -->
  <h2 class="section-title">🛍️ Vitrine des produits</h2>
  <div *ngIf="message" class="alert">{{ message }}</div>

  <div class="produits-grid">
    <div *ngFor="let produit of produits" class="produit-card">
      <div class="image-container">
        <img [src]="'https://localhost:7241' + produit.imageUrl" alt="{{ produit.nom }}" />
        <span *ngIf="produit.stock <= 5" class="badge stock-badge">Stock faible</span>
        <span class="badge new-badge">Nouveau</span>
      </div>
      <div class="produit-info">
        <h3>{{ produit.nom }}</h3>
        <p class="description">{{ produit.description }}</p>
        <p class="prix-stock"><strong>Prix :</strong> {{ produit.prix }} DT</p>
        <p class="prix-stock"><strong>Stock :</strong> {{ produit.stock }}</p>
        <button class="btn-ajouter" (click)="ajouterAuPanier(produit.id)">🛒 Ajouter</button>
      </div>
    </div>
  </div>

  <!-- ---------------- Mon Panier ---------------- -->
  <h2 class="section-title">🛒 Mon Panier</h2>

  <div class="panier-container" *ngIf="panierItems.length; else panierVide">
    <div class="panier-item" *ngFor="let item of panierItems">
      <ng-container *ngIf="item.produit">
        <img [src]="'https://localhost:7241' + item.produit.imageUrl" alt="{{ item.produit.nom }}" />
        <div class="panier-info">
          <h3>{{ item.produit.nom }}</h3>
          <p>Prix : {{ item.produit.prix }} DT</p>
          <p>Quantité : {{ item.quantite }}</p>
          <p>Sous-total : {{ item.produit.prix * item.quantite }} DT</p>
          <button class="btn-retirer" (click)="retirerDuPanier(item.id)">❌ Retirer</button>
        </div>
      </ng-container>
    </div>

    <div class="panier-total">
      <p><strong>Total :</strong> {{ getTotal() }} DT</p>
      <button class="btn-vider" (click)="viderPanier()">Vider le panier</button>
    </div>

    <!-- ---------------- Formulaire passer commande ---------------- -->
    <div class="commande-form">
      <h3>Passer la commande</h3>

      <label>
        Adresse de livraison :
        <input type="text" [(ngModel)]="adresseLivraison" placeholder="Adresse complète" />
      </label>

      <label>
        Mode de paiement :
        <select [(ngModel)]="modePaiement">
          <option value="en ligne">En ligne</option>
          <option value="CashOnDelivery">À la livraison</option>
        </select>
      </label>

      <button class="btn-commander" (click)="passerCommande()">✅ Passer la commande</button>
    </div>

  </div>

  <ng-template #panierVide>
    <p class="panier-vide">Votre panier est vide.</p>
  </ng-template>

  <button class="logout-btn" (click)="logout()">🚪 Déconnexion</button>

</div>
